{% extends "base.html" %}

{% block title %}HERA - Travel Arrangements{% endblock %}

{% block page_title %}Travel Arrangements{% endblock %}

{% block styles %}
<link href="{{ url_for('static', filename='css/travel.css') }}" rel="stylesheet">
{% endblock %}

{% block content %}
<!-- Flight Path Map -->
<div class="flight-map-container">
    <div class="widget">
        <div class="widget-header">
            <h3 class="widget-title">Flight Route</h3>
            <p class="widget-subtitle">Washington → Denver → Calgary → Toronto → Washington</p>
        </div>
        <div id="flight-map" class="flight-map"></div>
        <div class="flight-summary">
            <div class="flight-stat">
                <span class="stat-number">4</span>
                <span class="stat-label">Flights</span>
            </div>
            <div class="flight-stat">
                <span class="stat-number">~13h</span>
                <span class="stat-label">Total Flight Time</span>
            </div>
            <div class="flight-stat">
                <span class="stat-number">3</span>
                <span class="stat-label">Connections</span>
            </div>
        </div>
    </div>
</div>

<!-- Travel Sections -->
<div class="travel-sections">
    <!-- Outbound Flights -->
    <div class="widget">
        <div class="widget-header">
            <div>
                <h3 class="widget-title">
                    <i class="fas fa-plane-departure"></i>
                    Outbound Flights
                </h3>
                <p class="widget-subtitle">September 24, 2025 - Washington to Calgary</p>
            </div>
            <button class="action-btn add-btn" onclick="openAddFlightModal('outbound')" data-tooltip="Add Flight">
                <i class="fas fa-plus"></i>
            </button>
        </div>

        <div class="travel-cards">
            {% for travel in outbound_flights %}
            <div class="travel-card flight-card" data-travel-id="{{ travel.id }}">
                <div class="travel-header">
                    <div class="flight-route">
                        <span class="airport-code">{{ travel.segment.split(' - ')[0] }}</span>
                        <i class="fas fa-arrow-right"></i>
                        <span class="airport-code">{{ travel.segment.split(' - ')[1] }}</span>
                    </div>
                    <div class="flight-number">{{ travel.flightNumber }}</div>
                </div>

                <div class="travel-details">
                    <div class="travel-detail">
                        <div class="detail-label">Departure</div>
                        <div class="detail-value editable-text" data-field="departureTime" data-item-id="{{ travel.id }}">{{ travel.departureTime }}</div>
                    </div>
                    <div class="travel-detail">
                        <div class="detail-label">Arrival</div>
                        <div class="detail-value editable-text" data-field="arrivalTime" data-item-id="{{ travel.id }}">{{ travel.arrivalTime }}</div>
                    </div>
                    <div class="travel-detail">
                        <div class="detail-label">Duration</div>
                        <div class="detail-value">{{ travel.duration }}</div>
                    </div>
                    <div class="travel-detail">
                        <div class="detail-label">Seats</div>
                        <div class="detail-value editable-text" data-field="seat" data-item-id="{{ travel.id }}">{{ travel.seat }}</div>
                    </div>
                    <div class="travel-detail">
                        <div class="detail-label">Confirmation</div>
                        <div class="detail-value">{{ travel.confirmationNumber }}</div>
                    </div>
                    <div class="travel-detail">
                        <div class="detail-label">Status</div>
                        <div class="detail-value">
                            <span class="status-badge confirmed">{{ travel.status }}</span>
                        </div>
                    </div>
                </div>

                <div class="travel-actions">
                    <button class="action-btn edit-btn" onclick="openFlightEditModal({{ travel.id }})" data-tooltip="Edit Flight">
                        <i class="fas fa-edit"></i>
                    </button>
                    <button class="action-btn delete-btn" onclick="deleteTravel({{ travel.id }})" data-tooltip="Delete">
                        <i class="fas fa-trash"></i>
                    </button>
                </div>
            </div>
            {% endfor %}
        </div>
    </div>

    <!-- Return Flights -->
    <div class="widget">
        <div class="widget-header">
            <div>
                <h3 class="widget-title">
                    <i class="fas fa-plane-arrival"></i>
                    Return Flights
                </h3>
                <p class="widget-subtitle">September 29, 2025 - Calgary to Washington</p>
            </div>
            <button class="action-btn add-btn" onclick="openAddFlightModal('return')" data-tooltip="Add Flight">
                <i class="fas fa-plus"></i>
            </button>
        </div>

        <div class="travel-cards">
            {% for travel in return_flights %}
            <div class="travel-card flight-card" data-travel-id="{{ travel.id }}">
                <div class="travel-header">
                    <div class="flight-route">
                        <span class="airport-code">{{ travel.segment.split(' - ')[0] }}</span>
                        <i class="fas fa-arrow-right"></i>
                        <span class="airport-code">{{ travel.segment.split(' - ')[1] }}</span>
                    </div>
                    <div class="flight-number">{{ travel.flightNumber }}</div>
                </div>

                <div class="travel-details">
                    <div class="travel-detail">
                        <div class="detail-label">Departure</div>
                        <div class="detail-value editable-text" data-field="departureTime" data-item-id="{{ travel.id }}">{{ travel.departureTime }}</div>
                    </div>
                    <div class="travel-detail">
                        <div class="detail-label">Arrival</div>
                        <div class="detail-value editable-text" data-field="arrivalTime" data-item-id="{{ travel.id }}">{{ travel.arrivalTime }}</div>
                    </div>
                    <div class="travel-detail">
                        <div class="detail-label">Duration</div>
                        <div class="detail-value">{{ travel.duration }}</div>
                    </div>
                    <div class="travel-detail">
                        <div class="detail-label">Seats</div>
                        <div class="detail-value editable-text" data-field="seat" data-item-id="{{ travel.id }}">{{ travel.seat }}</div>
                    </div>
                    <div class="travel-detail">
                        <div class="detail-label">Confirmation</div>
                        <div class="detail-value">{{ travel.confirmationNumber }}</div>
                    </div>
                    <div class="travel-detail">
                        <div class="detail-label">Status</div>
                        <div class="detail-value">
                            <span class="status-badge confirmed">{{ travel.status }}</span>
                        </div>
                    </div>
                </div>

                <div class="travel-actions">
                    <button class="action-btn edit-btn" onclick="openFlightEditModal({{ travel.id }})" data-tooltip="Edit Flight">
                        <i class="fas fa-edit"></i>
                    </button>
                    <button class="action-btn delete-btn" onclick="deleteTravel({{ travel.id }})" data-tooltip="Delete">
                        <i class="fas fa-trash"></i>
                    </button>
                </div>
            </div>
            {% endfor %}
        </div>
    </div>

    <!-- Hotel Accommodations -->
    <div class="widget">
        <div class="widget-header">
            <div>
                <h3 class="widget-title">
                    <i class="fas fa-bed"></i>
                    Hotel Accommodations
                </h3>
                <p class="widget-subtitle">Canalta Lodge, Banff</p>
            </div>
            <button class="action-btn add-btn" onclick="openAddHotelModal()" data-tooltip="Add Hotel">
                <i class="fas fa-plus"></i>
            </button>
        </div>

        <div class="travel-cards">
            {% for travel in hotels %}
            <div class="travel-card hotel-card" data-travel-id="{{ travel.id }}">
                <div class="travel-header">
                    <div class="hotel-name">{{ travel.provider }}</div>
                    <div class="hotel-rating">
                        <span class="status-badge confirmed">{{ travel.status }}</span>
                    </div>
                </div>

                <div class="hotel-address">{{ travel.address }}</div>

                <div class="travel-details">
                    <div class="travel-detail">
                        <div class="detail-label">Check-in</div>
                        <div class="detail-value editable-text" data-field="checkIn" data-item-id="{{ travel.id }}">{{ travel.checkIn }}</div>
                    </div>
                    <div class="travel-detail">
                        <div class="detail-label">Check-out</div>
                        <div class="detail-value editable-text" data-field="checkOut" data-item-id="{{ travel.id }}">{{ travel.checkOut }}</div>
                    </div>
                    <div class="travel-detail">
                        <div class="detail-label">Room Type</div>
                        <div class="detail-value editable-text" data-field="roomType" data-item-id="{{ travel.id }}">{{ travel.roomType }}</div>
                    </div>
                    <div class="travel-detail">
                        <div class="detail-label">Phone</div>
                        <div class="detail-value">{{ travel.phone }}</div>
                    </div>
                    <div class="travel-detail">
                        <div class="detail-label">Confirmation</div>
                        <div class="detail-value">{{ travel.confirmationNumber }}</div>
                    </div>
                </div>

                <div class="travel-actions">
                    <button class="action-btn edit-btn" onclick="openHotelEditModal({{ travel.id }})" data-tooltip="Edit Hotel">
                        <i class="fas fa-edit"></i>
                    </button>
                    <button class="action-btn delete-btn" onclick="deleteTravel({{ travel.id }})" data-tooltip="Delete">
                        <i class="fas fa-trash"></i>
                    </button>
                </div>
            </div>
            {% endfor %}
        </div>
    </div>

    <!-- Ground Transportation -->
    <div class="widget">
        <div class="widget-header">
            <div>
                <h3 class="widget-title">
                    <i class="fas fa-car"></i>
                    Ground Transportation
                </h3>
                <p class="widget-subtitle">Rental cars and local transport</p>
            </div>
            <button class="action-btn add-btn" onclick="openAddTransportModal()" data-tooltip="Add Transport">
                <i class="fas fa-plus"></i>
            </button>
        </div>

        <div class="travel-cards">
            {% for travel in ground_transport %}
            <div class="travel-card transport-card" data-travel-id="{{ travel.id }}">
                <div class="travel-header">
                    <div class="transport-provider">{{ travel.provider }}</div>
                    <div class="transport-location">{{ travel.location }}</div>
                </div>

                <div class="travel-details">
                    <div class="travel-detail">
                        <div class="detail-label">Car Type</div>
                        <div class="detail-value editable-text" data-field="carType" data-item-id="{{ travel.id }}">{{ travel.carType }}</div>
                    </div>
                    <div class="travel-detail">
                        <div class="detail-label">Pickup Date</div>
                        <div class="detail-value editable-text" data-field="pickupDate" data-item-id="{{ travel.id }}">{{ travel.pickupDate }}</div>
                    </div>
                    <div class="travel-detail">
                        <div class="detail-label">Confirmation</div>
                        <div class="detail-value">{{ travel.confirmationNumber }}</div>
                    </div>
                    <div class="travel-detail">
                        <div class="detail-label">Status</div>
                        <div class="detail-value">
                            <span class="status-badge confirmed">{{ travel.status }}</span>
                        </div>
                    </div>
                </div>

                <div class="travel-actions">
                    <button class="action-btn edit-btn" onclick="openTransportEditModal({{ travel.id }})" data-tooltip="Edit Transport">
                        <i class="fas fa-edit"></i>
                    </button>
                    <button class="action-btn delete-btn" onclick="deleteTravel({{ travel.id }})" data-tooltip="Delete">
                        <i class="fas fa-trash"></i>
                    </button>
                </div>
            </div>
            {% endfor %}
        </div>
    </div>
</div>

<!-- Flight Edit Modal -->
<div id="flight-edit-modal" class="modal">
    <div class="modal-content">
        <div class="modal-header">
            <h3 class="modal-title" id="flight-modal-title">Edit Flight</h3>
            <button class="modal-close" onclick="closeFlightEditModal()">&times;</button>
        </div>
        <form id="flight-edit-form">
            <div class="modal-body">
                <input type="hidden" id="flight-item-id">

                <div class="form-row">
                    <div class="form-group">
                        <label class="form-label">Flight Number</label>
                        <input type="text" class="form-input" id="flight-number" required>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Airline</label>
                        <input type="text" class="form-input" id="flight-airline" required>
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label class="form-label">Departure Time</label>
                        <input type="time" class="form-input" id="flight-departure" required>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Arrival Time</label>
                        <input type="time" class="form-input" id="flight-arrival" required>
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label class="form-label">Date</label>
                        <input type="date" class="form-input" id="flight-date" required>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Duration</label>
                        <input type="text" class="form-input" id="flight-duration" placeholder="e.g., 3h 48m">
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label class="form-label">Seats</label>
                        <input type="text" class="form-input" id="flight-seats" placeholder="e.g., 2E, 2F">
                    </div>
                    <div class="form-group">
                        <label class="form-label">Confirmation Number</label>
                        <input type="text" class="form-input" id="flight-confirmation">
                    </div>
                </div>

                <div class="form-group">
                    <label class="form-label">Status</label>
                    <select class="form-select" id="flight-status">
                        <option value="Confirmed">Confirmed</option>
                        <option value="Pending">Pending</option>
                        <option value="Cancelled">Cancelled</option>
                    </select>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" onclick="closeFlightEditModal()">Cancel</button>
                <button type="submit" class="btn btn-primary">
                    <i class="fas fa-save"></i>
                    Save Changes
                </button>
            </div>
        </form>
    </div>
</div>

<!-- Hotel Edit Modal -->
<div id="hotel-edit-modal" class="modal">
    <div class="modal-content">
        <div class="modal-header">
            <h3 class="modal-title">Edit Hotel</h3>
            <button class="modal-close" onclick="closeHotelEditModal()">&times;</button>
        </div>
        <form id="hotel-edit-form">
            <div class="modal-body">
                <input type="hidden" id="hotel-item-id">

                <div class="form-group">
                    <label class="form-label">Hotel Name</label>
                    <input type="text" class="form-input" id="hotel-name" required>
                </div>

                <div class="form-group">
                    <label class="form-label">Address</label>
                    <textarea class="form-textarea" id="hotel-address" rows="2" required></textarea>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label class="form-label">Phone</label>
                        <input type="tel" class="form-input" id="hotel-phone">
                    </div>
                    <div class="form-group">
                        <label class="form-label">Room Type</label>
                        <input type="text" class="form-input" id="hotel-room-type">
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label class="form-label">Check-in Time</label>
                        <input type="time" class="form-input" id="hotel-checkin">
                    </div>
                    <div class="form-group">
                        <label class="form-label">Check-out Time</label>
                        <input type="time" class="form-input" id="hotel-checkout">
                    </div>
                </div>

                <div class="form-group">
                    <label class="form-label">Confirmation Number</label>
                    <input type="text" class="form-input" id="hotel-confirmation">
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" onclick="closeHotelEditModal()">Cancel</button>
                <button type="submit" class="btn btn-primary">
                    <i class="fas fa-save"></i>
                    Save Changes
                </button>
            </div>
        </form>
    </div>
</div>

<!-- Transport Edit Modal -->
<div id="transport-edit-modal" class="modal">
    <div class="modal-content">
        <div class="modal-header">
            <h3 class="modal-title">Edit Transportation</h3>
            <button class="modal-close" onclick="closeTransportEditModal()">&times;</button>
        </div>
        <form id="transport-edit-form">
            <div class="modal-body">
                <input type="hidden" id="transport-item-id">

                <div class="form-row">
                    <div class="form-group">
                        <label class="form-label">Provider</label>
                        <input type="text" class="form-input" id="transport-provider" required>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Location</label>
                        <input type="text" class="form-input" id="transport-location" required>
                    </div>
                </div>

                <div class="form-group">
                    <label class="form-label">Vehicle Type</label>
                    <input type="text" class="form-input" id="transport-car-type" required>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label class="form-label">Pickup Date</label>
                        <input type="date" class="form-input" id="transport-pickup-date" required>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Return Date</label>
                        <input type="date" class="form-input" id="transport-return-date">
                    </div>
                </div>

                <div class="form-group">
                    <label class="form-label">Confirmation Number</label>
                    <input type="text" class="form-input" id="transport-confirmation">
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" onclick="closeTransportEditModal()">Cancel</button>
                <button type="submit" class="btn btn-primary">
                    <i class="fas fa-save"></i>
                    Save Changes
                </button>
            </div>
        </form>
    </div>
</div>
{% endblock %}

{% block scripts %}
<script src="{{ url_for('static', filename='js/travel.js') }}"></script>
<script>
    // Pass data to JavaScript
    window.TRAVEL_DATA = {
        outbound: {{ outbound_flights | tojson }},
        return: {{ return_flights | tojson }},
        hotels: {{ hotels | tojson }},
        transport: {{ ground_transport | tojson }}
    };
</script>
{% endblock %}